-- [[ LARB SYSTEM v7.1.0 | CHANGELOG v9 ]]
-- Mode: Code (Security & Logic Patches)
-- Security: Reduced Mob Bring radius (150), VirtualInputManager implementation
-- Logic: Quest validation check, Smart Weapon Equip (Anti-Fruit-Eat)

local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
   Name = "LARB HACK | Blox Fruits Ultimate",
   LoadingTitle = "AA-7.0 Optimization",
   LoadingSubtitle = "By LARB SYSTEM",
   ConfigurationSaving = {
      Enabled = true,
      FolderName = "LarbHackConfig",
      FileName = "BloxFruits"
   },
   KeySystem = false,
})

local MainTab = Window:CreateTab("Auto Farm", 4483362458)
local StatsTab = Window:CreateTab("Auto Stats", 4483362458)
local TeleportTab = Window:CreateTab("Teleport", 4483362458)
local ShopTab = Window:CreateTab("Shop", 4483362458)
local ESPTab = Window:CreateTab("ESP", 4483362458)
local MiscTab = Window:CreateTab("Misc", 4483362458)

local StatusLabel = MainTab:CreateLabel("Status: Idle")

-- Variables
_G.AutoFarm = false
_G.AutoQuest = true -- Default to true if AutoFarm is on
_G.AutoChest = false
_G.AutoStats = false
_G.AutoHaki = true
_G.AutoSkills = true
_G.SelectStat = "Melee" 
_G.ESPPlayer = false
_G.ESPChest = false
_G.ESPFruit = false
_G.WalkSpeed = 16
_G.JumpPower = 50
_G.AutoBuyRandomFruit = false
_G.AutoBuyFightingStyle = false
_G.SelectFightingStyle = "Black Leg"
_G.AutoBuyHakiColor = false
_G.AutoBuyLegendarySword = false

-- Data Tables
local QuestList = {
    -- Format: {LevelReq, QuestName, QuestGiverName, MobName, MobLevel}
    {0, "BanditQuest1", "Bandit Quest Giver", "Bandit", 5},
    {10, "JungleQuest", "Monkey Quest Giver", "Monkey", 14},
    {15, "JungleQuest", "Monkey Quest Giver", "Gorilla", 20},
    {30, "BuggyQuest1", "Pirate Adventurer", "Pirate", 35}, 
    {40, "BuggyQuest1", "Pirate Adventurer", "Brute", 45},
    {60, "DesertQuest", "Desert Adventurer", "Desert Bandit", 60},
    {75, "DesertQuest", "Desert Adventurer", "Desert Officer", 70},
    {90, "SnowQuest", "Snow Quest Giver", "Snow Bandit", 90},
    {105, "SnowQuest", "Snow Quest Giver", "Snowman", 100},
    {120, "MarineQuest2", "Marine Quest Giver", "Chief Petty Officer", 120},
    {130, "SkyExp1Quest", "Sky Adventurer", "Sky Bandit", 150},
    {150, "SkyExp1Quest", "Sky Adventurer", "Dark Master", 175},
    {175, "ColosseumQuest", "Quest Giver", "Toga Warrior", 180},
    {190, "ColosseumQuest", "Quest Giver", "Gladiator", 200},
    -- Prison
    {220, "PrisonerQuest", "Prisoner Quest Giver", "Warden", 220},
    {230, "PrisonerQuest", "Prisoner Quest Giver", "Chief Warden", 230},
    {240, "PrisonerQuest", "Prisoner Quest Giver", "Swan", 240},
    -- Magma Village
    {300, "MagmaQuest", "Magma Quest Giver", "Military Soldier", 300},
    {325, "MagmaQuest", "Magma Quest Giver", "Military Spy", 325},
    {350, "MagmaQuest", "Magma Quest Giver", "Magma Admiral", 350},
    -- Underwater City
    {375, "FishmanQuest", "Fishman Quest Giver", "Fishman Warrior", 375},
    {400, "FishmanQuest", "Fishman Quest Giver", "Fishman Commando", 400},
    -- Skylands Upper Yard
    {450, "SkyExp2Quest", "Sky Adventurer", "God's Guard", 450},
    {475, "SkyExp2Quest", "Sky Adventurer", "Shanda", 475},
    {500, "SkyExp2Quest", "Sky Adventurer", "Wysper", 500},
    -- Fountain City
    {625, "FountainQuest", "Fountain Quest Giver", "Galley Pirate", 625},
}

-- Services
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TweenService = game:GetService("TweenService")
local VirtualUser = game:GetService("VirtualUser")
local Workspace = game:GetService("Workspace")

local LocalPlayer = Players.LocalPlayer
local CommF = ReplicatedStorage:WaitForChild("Remotes"):WaitForChild("CommF_")

-- Helper Functions
local function UpdateStatus(text)
    StatusLabel:Set("Status: " .. text)
end

local function GetCurrentQuestData()
    local myLevel = LocalPlayer.Data.Level.Value
    local bestQuest = nil
    
    for _, q in ipairs(QuestList) do
        if myLevel >= q[1] then
            bestQuest = q
        end
    end
    return bestQuest
end

local function CheckActiveQuest()
    local PlayerGui = LocalPlayer:FindFirstChild("PlayerGui")
    if PlayerGui and PlayerGui:FindFirstChild("Main") and PlayerGui.Main:FindFirstChild("Quest") then
        return PlayerGui.Main.Quest.Visible
    end
    return false
end

local function GetActiveQuestTarget()
    -- Attempt to read Quest Title from GUI
    local PlayerGui = LocalPlayer:FindFirstChild("PlayerGui")
    if PlayerGui and PlayerGui:FindFirstChild("Main") and PlayerGui.Main:FindFirstChild("Quest") and PlayerGui.Main.Quest.Visible then
        local Container = PlayerGui.Main.Quest:FindFirstChild("Container")
        if Container and Container:FindFirstChild("QuestTitle") and Container.QuestTitle:FindFirstChild("Title") then
            local text = Container.QuestTitle.Title.Text
            -- Format is usually "Defeat [Amount] [MobName]" or just "[MobName]"
            -- Simple parse: try to match known mobs from QuestList
            for _, q in ipairs(QuestList) do
                 if text:find(q[4]) then
                     return q[4]
                 end
            end
        end
    end
    return nil
end

local function TweenTo(targetCFrame)
    local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    if not Character:FindFirstChild("HumanoidRootPart") then return end
    
    local Distance = (Character.HumanoidRootPart.Position - targetCFrame.Position).Magnitude
    local Speed = 300 
    local Info = TweenInfo.new(Distance / Speed, Enum.EasingStyle.Linear)
    
    local Tween = TweenService:Create(Character.HumanoidRootPart, Info, {CFrame = targetCFrame})
    Tween:Play()
    
    -- Anti-Fall / NoClip during tween
    local Noclip = game:GetService("RunService").Stepped:Connect(function()
        for _, part in pairs(Character:GetChildren()) do
            if part:IsA("BasePart") then part.CanCollide = false end
        end
    end)
    
    Tween.Completed:Wait()
    Noclip:Disconnect()
end

local function FindNPC(name)
    -- Prioritize NPCs folder
    if Workspace:FindFirstChild("NPCs") then
        for _, v in pairs(Workspace.NPCs:GetChildren()) do
            if v.Name == name or v.Name:find(name) then
                return v
            end
        end
    end
    
    -- Search everywhere else (Cache this if possible, but for now linear search)
    for _, v in pairs(Workspace:GetChildren()) do
        if (v.Name == name or v.Name:find(name)) and v:IsA("Model") and v:FindFirstChild("Head") then
            return v
        end
    end
    return nil
end

-- ESP Functions
local function CreateESP(target, name, color)
    local BillboardGui = Instance.new("BillboardGui")
    local TextLabel = Instance.new("TextLabel")
    
    BillboardGui.Name = "ESP"
    BillboardGui.Adornee = target
    BillboardGui.Size = UDim2.new(0, 200, 0, 50)
    BillboardGui.StudsOffset = Vector3.new(0, 2, 0)
    BillboardGui.AlwaysOnTop = true
    BillboardGui.Parent = target
    
    TextLabel.Parent = BillboardGui
    TextLabel.BackgroundTransparency = 1
    TextLabel.Size = UDim2.new(1, 0, 1, 0)
    TextLabel.Text = name
    TextLabel.TextColor3 = color
    TextLabel.TextStrokeTransparency = 0
end

-- ESP Loops
spawn(function()
    while task.wait(1) do
        if _G.ESPPlayer then
            for _, v in pairs(Players:GetPlayers()) do
                if v ~= LocalPlayer and v.Character and v.Character:FindFirstChild("Head") and not v.Character.Head:FindFirstChild("ESP") then
                    CreateESP(v.Character.Head, v.Name, Color3.new(1, 0, 0))
                end
            end
        else
            for _, v in pairs(Players:GetPlayers()) do
                 if v.Character and v.Character:FindFirstChild("Head") and v.Character.Head:FindFirstChild("ESP") then
                    v.Character.Head.ESP:Destroy()
                 end
            end
        end
        
        if _G.ESPChest then
            for _, v in pairs(Workspace:GetChildren()) do
                if v.Name:find("Chest") and not v:FindFirstChild("ESP") then
                    CreateESP(v, v.Name, Color3.new(1, 1, 0))
                end
            end
        end
        
        if _G.ESPFruit then
            for _, v in pairs(Workspace:GetChildren()) do
                if v.Name:find("Fruit") and not v:FindFirstChild("ESP") and v:IsA("Tool") then -- Dropped Fruits
                     if v:FindFirstChild("Handle") then
                        CreateESP(v.Handle, v.Name, Color3.new(0, 1, 0))
                     end
                end
            end
        end
    end
end)

-- Main Loop
spawn(function()
    while task.wait() do
        if _G.AutoFarm then
            pcall(function()
                local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
                local HumanoidRootPart = Character:FindFirstChild("HumanoidRootPart")
                if not HumanoidRootPart then return end
                
                local QuestData = GetCurrentQuestData()
                local TargetMobName = nil
                
                -- 1. Check Active Quest
                if CheckActiveQuest() then
                    TargetMobName = GetActiveQuestTarget()
                    if not TargetMobName and QuestData then
                         -- Fallback: Use level-based quest mob if parsing fails
                         TargetMobName = QuestData[4] 
                    end
                else
                    -- No Quest Active
                    if _G.AutoQuest then
                        if not QuestData then 
                            UpdateStatus("Level Too Low / No Quest Found")
                            return 
                        end
                        
                        UpdateStatus("Getting Quest: " .. QuestData[2])
                        local NPC = FindNPC(QuestData[3])
                        
                        if NPC and NPC:FindFirstChild("HumanoidRootPart") then
                            local dist = (HumanoidRootPart.Position - NPC.HumanoidRootPart.Position).Magnitude
                            if dist > 8 then
                                TweenTo(NPC.HumanoidRootPart.CFrame)
                            else
                                -- Spam Request when close
                                CommF:InvokeServer("StartQuest", QuestData[2], 1)
                                CommF:InvokeServer("SetSpawnPoint")
                                task.wait(0.5)
                            end
                        else
                             UpdateStatus("NPC Not Found: " .. QuestData[3])
                             -- Try searching by partial name in Workspace
                             local found = false
                             for _, v in pairs(Workspace:GetChildren()) do
                                 if v.Name:find(QuestData[3]) and v:FindFirstChild("HumanoidRootPart") then
                                      TweenTo(v.HumanoidRootPart.CFrame)
                                      found = true
                                      break
                                 end
                             end
                             if not found then
                                 -- Desperate measure: Try StartQuest anyway (sometimes works if cached)
                                 CommF:InvokeServer("StartQuest", QuestData[2], 1)
                             end
                        end
                        return -- Stop loop to focus on getting quest
                    else
                         UpdateStatus("Auto Quest Disabled")
                    end
                end

                if not TargetMobName then
                     UpdateStatus("Waiting for Quest...")
                     return 
                end

                UpdateStatus("Farming: " .. TargetMobName)

                -- 2. Mob Farming
                -- Bring Mobs (Safe Mode - Reduced Range)
                for _, enemy in pairs(Workspace.Enemies:GetChildren()) do
                    if enemy.Name:find(TargetMobName) and enemy:FindFirstChild("HumanoidRootPart") and (enemy.HumanoidRootPart.Position - HumanoidRootPart.Position).Magnitude < 150 then
                        enemy.HumanoidRootPart.CFrame = HumanoidRootPart.CFrame * CFrame.new(0,0,-5)
                        enemy.HumanoidRootPart.CanCollide = false
                        if enemy:FindFirstChild("Humanoid") then
                            enemy.Humanoid.WalkSpeed = 0
                            enemy.Humanoid.JumpPower = 0
                            -- Stun mod
                            if enemy.Humanoid:FindFirstChild("Animator") then
                                enemy.Humanoid.Animator:Destroy()
                            end
                        end
                    end
                end

                -- Find Closest Target
                local Target = nil
                local MinDist = math.huge
                for _, v in pairs(Workspace.Enemies:GetChildren()) do
                    if v.Name:find(TargetMobName) and v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 and v:FindFirstChild("HumanoidRootPart") then
                        local dist = (HumanoidRootPart.Position - v.HumanoidRootPart.Position).Magnitude
                        if dist < MinDist then
                            MinDist = dist
                            Target = v
                        end
                    end
                end
                    
                if Target then
                    -- Teleport/Tween to Mob
                    local AttackPos = Target.HumanoidRootPart.CFrame * CFrame.new(0, 5, 0)
                    local Distance = (HumanoidRootPart.Position - AttackPos.Position).Magnitude
                    
                    if Distance > 250 then
                         TweenTo(AttackPos)
                    elseif Distance > 10 then
                         HumanoidRootPart.CFrame = AttackPos
                    else
                         -- Lock on
                         HumanoidRootPart.CFrame = AttackPos
                    end
                    
                    -- Fast Attack (VirtualInputManager)
                    game:GetService("VirtualInputManager"):SendMouseButtonEvent(0, 0, 0, true, game, 1)
                    game:GetService("VirtualInputManager"):SendMouseButtonEvent(0, 0, 0, false, game, 1)
                    
                    -- Auto Skills
                    if _G.AutoSkills then
                        pcall(function()
                            local skills = {"Z", "X", "C", "V"}
                            for _, key in ipairs(skills) do
                                game:GetService("VirtualInputManager"):SendKeyEvent(true, key, false, game)
                                game:GetService("VirtualInputManager"):SendKeyEvent(false, key, false, game)
                            end
                        end)
                    end

                    -- Equip Weapon (Smart Equip)
                    local Equipped = false
                    for _, tool in pairs(LocalPlayer.Backpack:GetChildren()) do
                        if tool:IsA("Tool") and (tool.ToolTip == "Melee" or tool.ToolTip == "Sword") then
                            LocalPlayer.Character.Humanoid:EquipTool(tool)
                            Equipped = true
                            break
                        end
                    end
                    if not Equipped then
                         for _, tool in pairs(LocalPlayer.Backpack:GetChildren()) do
                            if tool:IsA("Tool") and not tool.Name:find("Fruit") then
                                LocalPlayer.Character.Humanoid:EquipTool(tool)
                                break
                            end
                         end
                    end
                else
                     UpdateStatus("Mob Not Found: " .. TargetMobName)
                     -- Maybe teleport to spawn location of mob?
                end
            end)
        end
    end
end)

-- Stats Loop
spawn(function()
    while task.wait(0.5) do
        if _G.AutoStats then
            pcall(function()
                if LocalPlayer.Data.Points.Value > 0 then
                    local StatMap = {
                        ["Melee"] = "Melee",
                        ["Defense"] = "Defense",
                        ["Sword"] = "Sword",
                        ["Gun"] = "Gun",
                        ["Demon Fruit"] = "Demon Fruit" 
                    }
                    CommF:InvokeServer("AddPoint", StatMap[_G.SelectStat], 1)
                end
            end)
        end
    end
end)

-- UI Setup
MainTab:CreateToggle({
   Name = "Enable Auto Farm",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoFarm = Value
   end,
})

MainTab:CreateToggle({
   Name = "Auto Skills (Z,X,C,V)",
   CurrentValue = true,
   Callback = function(Value)
      _G.AutoSkills = Value
   end,
})

MainTab:CreateToggle({
   Name = "Auto Buso Haki",
   CurrentValue = true,
   Callback = function(Value)
      _G.AutoHaki = Value
   end,
})

MainTab:CreateToggle({
   Name = "Auto Accept Quest",
   CurrentValue = true,
   Callback = function(Value)
      _G.AutoQuest = Value
   end,
})

MainTab:CreateLabel("Script will auto-detect level and quest")

StatsTab:CreateDropdown({
   Name = "Select Stat to Upgrade",
   Options = {"Melee", "Defense", "Sword", "Gun", "Demon Fruit"},
   CurrentOption = "Melee",
   Callback = function(Option)
      _G.SelectStat = Option
   end,
})

StatsTab:CreateToggle({
   Name = "Auto Stats",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoStats = Value
   end,
})

TeleportTab:CreateButton({
    Name = "Jungle",
    Callback = function()
        TweenTo(CFrame.new(-1432, 29, 2800)) -- Jungle Coords
    end,
})

TeleportTab:CreateButton({
    Name = "Pirate Village",
    Callback = function()
        TweenTo(CFrame.new(-1182, 4, 3832)) 
    end,
})

TeleportTab:CreateButton({
    Name = "Desert",
    Callback = function()
        TweenTo(CFrame.new(909, 6, 4376)) 
    end,
})

TeleportTab:CreateButton({
    Name = "Frozen Village",
    Callback = function()
        TweenTo(CFrame.new(1156, 4, -1149)) 
    end,
})

TeleportTab:CreateButton({
    Name = "Marine Fortress",
    Callback = function()
        TweenTo(CFrame.new(-4923, 20, 4220)) 
    end,
})

TeleportTab:CreateButton({
    Name = "Skylands",
    Callback = function()
        TweenTo(CFrame.new(-4839, 717, -2619)) 
    end,
})

TeleportTab:CreateButton({
    Name = "Prison",
    Callback = function()
        TweenTo(CFrame.new(4842, 5, 745)) 
    end,
})

TeleportTab:CreateButton({
    Name = "Colosseum",
    Callback = function()
        TweenTo(CFrame.new(-1658, 6, -2976)) 
    end,
})

-- Shop Tab
ShopTab:CreateToggle({
   Name = "Auto Buy Random Fruit",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoBuyRandomFruit = Value
   end,
})

ShopTab:CreateDropdown({
   Name = "Select Fighting Style",
   Options = {"Black Leg", "Electro", "Fishman Karate", "Dragon Breath"},
   CurrentOption = "Black Leg",
   Callback = function(Option)
      _G.SelectFightingStyle = Option
   end,
})

ShopTab:CreateToggle({
   Name = "Auto Buy Fighting Style",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoBuyFightingStyle = Value
   end,
})

ShopTab:CreateToggle({
   Name = "Auto Buy Haki Color",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoBuyHakiColor = Value
   end,
})

ShopTab:CreateToggle({
   Name = "Auto Buy Legendary Sword",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoBuyLegendarySword = Value
   end,
})

-- Shop Loop
spawn(function()
    while task.wait(1) do
        pcall(function()
            if _G.AutoBuyRandomFruit then
                CommF:InvokeServer("Cousin", "Buy")
            end
            
            if _G.AutoBuyFightingStyle then
                local StyleMap = {
                    ["Black Leg"] = "BuyBlackLeg",
                    ["Electro"] = "BuyElectro",
                    ["Fishman Karate"] = "BuyFishmanKarate",
                    ["Dragon Breath"] = "BuyDragonBreath"
                }
                CommF:InvokeServer(StyleMap[_G.SelectFightingStyle])
            end
            
            if _G.AutoBuyHakiColor then
                 -- Arguments for Haki Color Vendor might vary, simplistic attempt
                 CommF:InvokeServer("ActivateHakiColor") 
            end
            
            if _G.AutoBuyLegendarySword then
                -- Attempt to buy common legendary swords if vendor is open
                CommF:InvokeServer("BuySaber")
                CommF:InvokeServer("BuyBisento")
            end
        end)
    end
end)

ESPTab:CreateToggle({
   Name = "ESP Players",
   CurrentValue = false,
   Callback = function(Value)
      _G.ESPPlayer = Value
   end,
})

ESPTab:CreateToggle({
   Name = "ESP Chests",
   CurrentValue = false,
   Callback = function(Value)
      _G.ESPChest = Value
   end,
})

ESPTab:CreateToggle({
   Name = "ESP Dropped Fruits",
   CurrentValue = false,
   Callback = function(Value)
      _G.ESPFruit = Value
   end,
})

MiscTab:CreateButton({
    Name = "Redeem All Codes",
    Callback = function()
        local codes = {
            "Sub2Fer999", "Enyu_is_Pro", "Magicbus", "JCWK", "Starcodeheo", "Bluxxy", "fudd10_v2",
            "Fudd10", "BIGNEWS", "THEGREATACE", "SUB2GAMERROBOT_EXP1", "Sub2NoobMaster123",
            "Sub2UncleKizaru", "Sub2Daigrock", "Axiore", "TantaiGaming", "StrawHatMaine"
        }
        for _, code in ipairs(codes) do
            CommF:InvokeServer("RedeemCode", code)
            task.wait(0.5)
        end
    end,
})

MiscTab:CreateButton({
    Name = "Server Hop",
    Callback = function()
        local PlaceID = game.PlaceId
        local AllIDs = {}
        local found = false
        local JustStarted = true
        local ToSearch = game.HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Asc&limit=100"))
        for i, v in pairs(ToSearch.data) do
            if v.playing < v.maxPlayers then
                table.insert(AllIDs, v.id)
            end
        end
        local num = 0
        local function Teleport()
            if #AllIDs > 0 then
                game:GetService("TeleportService"):TeleportToPlaceInstance(PlaceID, AllIDs[math.random(1, #AllIDs)], LocalPlayer)
            end
        end
        Teleport()
    end,
})

MiscTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {16, 300},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = 16,
    Flag = "WalkSpeed", 
    Callback = function(Value)
        _G.WalkSpeed = Value
        LocalPlayer.Character.Humanoid.WalkSpeed = Value
    end,
})

MiscTab:CreateSlider({
    Name = "JumpPower",
    Range = {50, 300},
    Increment = 1,
    Suffix = "Jump",
    CurrentValue = 50,
    Flag = "JumpPower", 
    Callback = function(Value)
        _G.JumpPower = Value
        LocalPlayer.Character.Humanoid.JumpPower = Value
    end,
})

-- WalkSpeed Loop (To prevent override)
spawn(function()
    while task.wait(0.5) do
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            if LocalPlayer.Character.Humanoid.WalkSpeed ~= _G.WalkSpeed then
                 LocalPlayer.Character.Humanoid.WalkSpeed = _G.WalkSpeed
            end
            if LocalPlayer.Character.Humanoid.JumpPower ~= _G.JumpPower then
                 LocalPlayer.Character.Humanoid.JumpPower = _G.JumpPower
            end
        end
    end
end)

MiscTab:CreateToggle({
   Name = "Auto Chests",
   CurrentValue = false,
   Callback = function(Value)
      _G.AutoChest = Value
   end,
})

-- Auto Chest Loop
spawn(function()
    while task.wait(1) do
        if _G.AutoChest then
             pcall(function()
                local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
                for _, v in pairs(Workspace:GetChildren()) do
                    if v.Name:find("Chest") and (v.Position - Character.HumanoidRootPart.Position).Magnitude < 3000 then
                         TweenTo(v.CFrame)
                         wait(1)
                    end
                end
             end)
        end
    end
end)

-- Auto Haki Loop
spawn(function()
    while task.wait(5) do
        if _G.AutoHaki then
            pcall(function()
                if not LocalPlayer.Character:FindFirstChild("HasBuso") then
                    CommF:InvokeServer("Buso")
                end
            end)
        end
    end
end)
