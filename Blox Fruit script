local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local VirtualUser = game:GetService("VirtualUser")
local VirtualInputManager = game:GetService("VirtualInputManager")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")

local Player = Players.LocalPlayer
local _G = _G or {} 

-- // –ù–ê–°–¢–†–û–ô–ö–ò //
_G.AutoFarm = false
_G.AutoQuest = false
_G.FruitESP = false
_G.AutoCollectFruit = false
_G.ServerFruitHop = false -- –°–µ—Ä–≤–µ—Ä –•–æ–ø –¥–ª—è —Ñ—Ä—É–∫—Ç–æ–≤
_G.ReachAura = true -- –í–∫–ª—é—á–µ–Ω–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞
_G.AutoStats = false -- –ê–≤—Ç–æ-—Å—Ç–∞—Ç—ã
_G.AttackDist = 3
_G.MobileAttackOnly = true
_G.AutoHaki = true -- –ê–≤—Ç–æ –•–∞–∫–∏
_G.ChestESP = false -- –ï–°–ü –°—É–Ω–¥—É–∫–æ–≤
_G.SpeedBoost = false -- –°–∫–æ—Ä–æ—Å—Ç—å
_G.WalkOnWater = false -- –•–æ–¥—å–±–∞ –ø–æ –≤–æ–¥–µ
_G.InfGeppo = false -- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –ø—Ä—ã–∂–∫–∏
_G.SelectStat = "Melee" -- –í—ã–±—Ä–∞–Ω–Ω—ã–π —Å—Ç–∞—Ç
_G.AutoBuyRandomFruit = false -- –ê–≤—Ç–æ-–ø–æ–∫—É–ø–∫–∞ —Ñ—Ä—É–∫—Ç–æ–≤
_G.SmartAI = false -- –£–º–Ω—ã–π –ò–ò (–ê–≤—Ç–æ-—Å–∫–∏–ª–ª—ã)
_G.AutoPvP = false -- –ê–≤—Ç–æ-–ü–≤–ü (–æ—Ö–æ—Ç–∞ –Ω–∞ –∏–≥—Ä–æ–∫–æ–≤)
_G.AimBot = false -- –ê–∏–º–±–æ—Ç (–∫–∞–º–µ—Ä–∞)
local CurrentTarget = nil

-- –°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Ñ—Ä—É–∫—Ç–æ–≤
local FruitSpawnData = {
    LastSeenFruits = {},
    SpawnTimes = {},
    AverageSpawnTime = 3600,
    LastDespawnTime = 0
}

-- // GUI –ò–ù–¢–ï–†–§–ï–ô–° //
task.wait(1) -- –ñ–¥–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
if not game:IsLoaded() then game.Loaded:Wait() end

-- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä–æ–µ GUI –µ—Å–ª–∏ –µ—Å—Ç—å
local oldGui = Player:WaitForChild("PlayerGui"):FindFirstChild("BloxFruitMobileGUI_v3")
if oldGui then oldGui:Destroy() end

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "BloxFruitMobileGUI_v3"
ScreenGui.Parent = Player:WaitForChild("PlayerGui")
ScreenGui.ResetOnSpawn = false
ScreenGui.DisplayOrder = 1000
ScreenGui.IgnoreGuiInset = true -- –í–∞–∂–Ω–æ –¥–ª—è –º–æ–±–∏–ª–æ–∫!

-- –ö–Ω–æ–ø–∫–∞ –ú–ï–ù–Æ
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Name = "ToggleBtn"
ToggleBtn.Parent = ScreenGui
ToggleBtn.BackgroundColor3 = Color3.fromRGB(0, 120, 255)
-- –ü–æ–∑–∏—Ü–∏—è —á—É—Ç—å –Ω–∏–∂–µ (—á—Ç–æ–±—ã –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª–∞—Å—å —á–∞—Ç–æ–º)
ToggleBtn.Position = UDim2.new(0, 50, 0.3, 0) 
ToggleBtn.Size = UDim2.new(0, 60, 0, 60)
ToggleBtn.Font = Enum.Font.SourceSansBold
ToggleBtn.Text = "MENU"
ToggleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleBtn.TextSize = 16
ToggleBtn.ZIndex = 100
ToggleBtn.BorderSizePixel = 2
ToggleBtn.BorderColor3 = Color3.fromRGB(255, 255, 255)
ToggleBtn.Active = true
ToggleBtn.Draggable = false -- –û—Ç–∫–ª—é—á–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –¥—Ä–∞–≥, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–π

local UICornerBtn = Instance.new("UICorner")
UICornerBtn.CornerRadius = UDim.new(0.5, 0)
UICornerBtn.Parent = ToggleBtn

-- –û—Å–Ω–æ–≤–Ω–æ–µ –æ–∫–Ω–æ
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
MainFrame.Size = UDim2.new(0.5, 0, 0.65, 0)
MainFrame.Visible = false
MainFrame.ZIndex = 101
MainFrame.BorderSizePixel = 0

local UICornerFrame = Instance.new("UICorner")
UICornerFrame.CornerRadius = UDim.new(0.05, 0)
UICornerFrame.Parent = MainFrame

-- –ó–∞–≥–æ–ª–æ–≤–æ–∫
local Title = Instance.new("TextLabel")
Title.Parent = MainFrame
Title.Text = "BLOX FRUITS SCRIPT v3.4 (AI PRO)"
Title.Size = UDim2.new(1, 0, 0.12, 0)
Title.BackgroundColor3 = Color3.fromRGB(255, 85, 0)
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.Font = Enum.Font.SourceSansBold
Title.TextSize = 18
Title.ZIndex = 102

local UICornerTitle = Instance.new("UICorner")
UICornerTitle.CornerRadius = UDim.new(0.1, 0)
UICornerTitle.Parent = Title

-- –ö–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏—è –∏ –∫–ª–∏–∫–∞ (Mobile Friendly)
local function MakeDraggableAndClickable(obj, onClick)
    local UserInputService = game:GetService("UserInputService")
    local dragging = false
    local dragInput, dragStart, startPos
    local isMoved = false

    local function update(input)
        local delta = input.Position - dragStart
        obj.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
        if delta.Magnitude > 10 then isMoved = true end -- –ü–æ—Ä–æ–≥ –¥–≤–∏–∂–µ–Ω–∏—è
    end

    obj.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            dragging = true
            dragStart = input.Position
            startPos = obj.Position
            isMoved = false
            
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then
                    dragging = false
                    if not isMoved and onClick then onClick() end
                end
            end)
        end
    end)

    obj.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            dragInput = input
        end
    end)

    UserInputService.InputChanged:Connect(function(input)
        if input == dragInput and dragging then
            update(input)
        end
    end)
end

-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏–∫—É –∫ –∫–Ω–æ–ø–∫–µ
local TabBar = Instance.new("Frame")
TabBar.Parent = MainFrame
TabBar.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
TabBar.Size = UDim2.new(1, 0, 0.1, 0)
TabBar.Position = UDim2.new(0, 0, 0.12, 0)
TabBar.ZIndex = 104

local TabFarm = Instance.new("TextButton")
TabFarm.Parent = TabBar
TabFarm.Size = UDim2.new(0.2, 0, 1, 0)
TabFarm.Position = UDim2.new(0, 0, 0, 0)
TabFarm.Text = "Farm"
TabFarm.Font = Enum.Font.SourceSansBold
TabFarm.TextSize = 16
TabFarm.TextColor3 = Color3.fromRGB(255, 255, 255)
TabFarm.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
TabFarm.ZIndex = 105

local TabFruit = Instance.new("TextButton")
TabFruit.Parent = TabBar
TabFruit.Size = UDim2.new(0.2, 0, 1, 0)
TabFruit.Position = UDim2.new(0.2, 0, 0, 0)
TabFruit.Text = "Fruit"
TabFruit.Font = Enum.Font.SourceSansBold
TabFruit.TextSize = 16
TabFruit.TextColor3 = Color3.fromRGB(255, 255, 255)
TabFruit.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
TabFruit.ZIndex = 105

local TabIslands = Instance.new("TextButton")
TabIslands.Parent = TabBar
TabIslands.Size = UDim2.new(0.2, 0, 1, 0)
TabIslands.Position = UDim2.new(0.4, 0, 0, 0)
TabIslands.Text = "Islands"
TabIslands.Font = Enum.Font.SourceSansBold
TabIslands.TextSize = 16
TabIslands.TextColor3 = Color3.fromRGB(255, 255, 255)
TabIslands.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
TabIslands.ZIndex = 105

local TabPvP = Instance.new("TextButton")
TabPvP.Parent = TabBar
TabPvP.Size = UDim2.new(0.2, 0, 1, 0)
TabPvP.Position = UDim2.new(0.6, 0, 0, 0)
TabPvP.Text = "PvP/AI"
TabPvP.Font = Enum.Font.SourceSansBold
TabPvP.TextSize = 16
TabPvP.TextColor3 = Color3.fromRGB(255, 255, 255)
TabPvP.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
TabPvP.ZIndex = 105

local TabSettings = Instance.new("TextButton")
TabSettings.Parent = TabBar
TabSettings.Size = UDim2.new(0.2, 0, 1, 0)
TabSettings.Position = UDim2.new(0.8, 0, 0, 0)
TabSettings.Text = "Settings"
TabSettings.Font = Enum.Font.SourceSansBold
TabSettings.TextSize = 16
TabSettings.TextColor3 = Color3.fromRGB(255, 255, 255)
TabSettings.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
TabSettings.ZIndex = 105

-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏
for i = 1, 4 do
    local sep = Instance.new("Frame")
    sep.Parent = TabBar
    sep.Size = UDim2.new(0, 2, 0.8, 0)
    sep.Position = UDim2.new(i * 0.2, -1, 0.1, 0)
    sep.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    sep.BorderSizePixel = 0
    sep.ZIndex = 106
end

-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Parent = MainFrame
ContentFrame.BackgroundTransparency = 1
ContentFrame.Size = UDim2.new(1, 0, 0.78, 0)
ContentFrame.Position = UDim2.new(0, 0, 0.22, 0)
ContentFrame.ZIndex = 102

-- –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
local FarmFrame = Instance.new("ScrollingFrame")
FarmFrame.Name = "FarmFrame"
FarmFrame.Parent = ContentFrame
FarmFrame.Size = UDim2.new(1, 0, 1, 0)
FarmFrame.BackgroundTransparency = 1
FarmFrame.Visible = true
FarmFrame.ScrollBarThickness = 4

local FruitFrame = Instance.new("ScrollingFrame")
FruitFrame.Name = "FruitFrame"
FruitFrame.Parent = ContentFrame
FruitFrame.Size = UDim2.new(1, 0, 1, 0)
FruitFrame.BackgroundTransparency = 1
FruitFrame.Visible = false
FruitFrame.ScrollBarThickness = 4

local IslandsFrame = Instance.new("ScrollingFrame")
IslandsFrame.Name = "IslandsFrame"
IslandsFrame.Parent = ContentFrame
IslandsFrame.Size = UDim2.new(1, 0, 1, 0)
IslandsFrame.BackgroundTransparency = 1
IslandsFrame.Visible = false
IslandsFrame.ScrollBarThickness = 4

local PvPFrame = Instance.new("ScrollingFrame")
PvPFrame.Name = "PvPFrame"
PvPFrame.Parent = ContentFrame
PvPFrame.Size = UDim2.new(1, 0, 1, 0)
PvPFrame.BackgroundTransparency = 1
PvPFrame.Visible = false
PvPFrame.ScrollBarThickness = 4

local SettingsFrame = Instance.new("ScrollingFrame")
SettingsFrame.Name = "SettingsFrame"
SettingsFrame.Parent = ContentFrame
SettingsFrame.Size = UDim2.new(1, 0, 1, 0)
SettingsFrame.BackgroundTransparency = 1
SettingsFrame.Visible = false
SettingsFrame.ScrollBarThickness = 4

local function ShowTab(tab)
    FarmFrame.Visible = (tab == "Farm")
    FruitFrame.Visible = (tab == "Fruit")
    IslandsFrame.Visible = (tab == "Islands")
    PvPFrame.Visible = (tab == "PvP")
    SettingsFrame.Visible = (tab == "Settings")
end

TabFarm.Activated:Connect(function() ShowTab("Farm") end)
TabFruit.Activated:Connect(function() ShowTab("Fruit") end)
TabIslands.Activated:Connect(function() ShowTab("Islands") end)
TabPvP.Activated:Connect(function() ShowTab("PvP") end)
TabSettings.Activated:Connect(function() ShowTab("Settings") end)

MakeDraggableAndClickable(ToggleBtn, function()
    MainFrame.Visible = not MainFrame.Visible
end)

-- –°—á–µ—Ç—á–∏–∫ –∫–Ω–æ–ø–æ–∫ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
local ButtonCountFarm = 0
local ButtonCountFruit = 0
local ButtonCountSettings = 0
local ButtonCountIslands = 0
local ButtonCountPvP = 0

-- –§—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–æ–ø–æ–∫ (Toggle)
local function CreateSwitch(parent, index, text, defaultVal, callback)
    local btn = Instance.new("TextButton")
    btn.Parent = parent
    btn.BackgroundColor3 = defaultVal and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(200, 0, 0)
    btn.Size = UDim2.new(0.9, 0, 0.10, 0) -- –ö–æ–º–ø–∞–∫—Ç–Ω—ã–π —Ä–∞–∑–º–µ—Ä
    btn.Position = UDim2.new(0.05, 0, 0.05 + index * 0.11, 0)
    btn.Text = text .. ": " .. (defaultVal and "ON" or "OFF")
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 14
    btn.ZIndex = 103
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.2, 0)
    corner.Parent = btn
    
    btn.Activated:Connect(function()
        local isOn = not (btn.Text:find("ON") ~= nil)
        btn.Text = text .. ": " .. (isOn and "ON" or "OFF")
        btn.BackgroundColor3 = isOn and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(200, 0, 0)
        callback(isOn)
    end)
end

local function CreateButton(parent, index, text, callback)
    local btn = Instance.new("TextButton")
    btn.Parent = parent
    btn.BackgroundColor3 = Color3.fromRGB(0, 120, 200)
    btn.Size = UDim2.new(0.9, 0, 0.10, 0)
    btn.Position = UDim2.new(0.05, 0, 0.05 + index * 0.11, 0)
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 14
    btn.ZIndex = 103
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0.2, 0)
    corner.Parent = btn
    btn.Activated:Connect(function()
        callback()
    end)
    return btn
end

CreateSwitch(FarmFrame, ButtonCountFarm, "Auto Farm", _G.AutoFarm, function(val) _G.AutoFarm = val end); ButtonCountFarm = ButtonCountFarm + 1
CreateSwitch(FarmFrame, ButtonCountFarm, "Auto Quest", _G.AutoQuest, function(val) _G.AutoQuest = val end); ButtonCountFarm = ButtonCountFarm + 1
CreateSwitch(FarmFrame, ButtonCountFarm, "Hitbox Reach", _G.ReachAura, function(val) _G.ReachAura = val end); ButtonCountFarm = ButtonCountFarm + 1
CreateSwitch(FruitFrame, ButtonCountFruit, "Fruit ESP", _G.FruitESP, function(val) _G.FruitESP = val end); ButtonCountFruit = ButtonCountFruit + 1
CreateSwitch(FruitFrame, ButtonCountFruit, "Auto Collect Fruit", _G.AutoCollectFruit, function(val) _G.AutoCollectFruit = val end); ButtonCountFruit = ButtonCountFruit + 1
CreateSwitch(FruitFrame, ButtonCountFruit, "Server Fruit Hop", _G.ServerFruitHop, function(val) _G.ServerFruitHop = val end); ButtonCountFruit = ButtonCountFruit + 1
CreateSwitch(FruitFrame, ButtonCountFruit, "Chest ESP", _G.ChestESP, function(val) _G.ChestESP = val end); ButtonCountFruit = ButtonCountFruit + 1
CreateSwitch(FruitFrame, ButtonCountFruit, "Auto Buy Random Fruit", _G.AutoBuyRandomFruit, function(val) _G.AutoBuyRandomFruit = val end); ButtonCountFruit = ButtonCountFruit + 1

CreateSwitch(PvPFrame, ButtonCountPvP, "Smart AI (Auto Skills)", _G.SmartAI, function(val) _G.SmartAI = val end); ButtonCountPvP = ButtonCountPvP + 1
CreateSwitch(PvPFrame, ButtonCountPvP, "Auto PvP (Hunt Players)", _G.AutoPvP, function(val) _G.AutoPvP = val end); ButtonCountPvP = ButtonCountPvP + 1
CreateSwitch(PvPFrame, ButtonCountPvP, "Aim Bot (Camera Lock)", _G.AimBot, function(val) _G.AimBot = val end); ButtonCountPvP = ButtonCountPvP + 1

CreateSwitch(SettingsFrame, ButtonCountSettings, "Auto Stats", _G.AutoStats, function(val) _G.AutoStats = val end); ButtonCountSettings = ButtonCountSettings + 1

local StatsList = {"Melee", "Defense", "Sword", "Gun", "Demon Fruit"}
local StatIdx = 1
local statBtn
statBtn = CreateButton(SettingsFrame, ButtonCountSettings, "Select Stat: Melee", function()
    StatIdx = StatIdx + 1
    if StatIdx > #StatsList then StatIdx = 1 end
    _G.SelectStat = StatsList[StatIdx]
    if statBtn then statBtn.Text = "Select Stat: " .. StatsList[StatIdx] end
end); ButtonCountSettings = ButtonCountSettings + 1

CreateSwitch(SettingsFrame, ButtonCountSettings, "Mobile Attack Only", _G.MobileAttackOnly, function(val) _G.MobileAttackOnly = val end); ButtonCountSettings = ButtonCountSettings + 1
CreateSwitch(SettingsFrame, ButtonCountSettings, "Auto Aura (Buso)", _G.AutoHaki, function(val) _G.AutoHaki = val end); ButtonCountSettings = ButtonCountSettings + 1
CreateSwitch(SettingsFrame, ButtonCountSettings, "Speed Boost (60)", _G.SpeedBoost, function(val) _G.SpeedBoost = val end); ButtonCountSettings = ButtonCountSettings + 1
CreateSwitch(SettingsFrame, ButtonCountSettings, "Walk On Water", _G.WalkOnWater, function(val) _G.WalkOnWater = val end); ButtonCountSettings = ButtonCountSettings + 1
CreateSwitch(SettingsFrame, ButtonCountSettings, "Infinite Geppo", _G.InfGeppo, function(val) _G.InfGeppo = val end); ButtonCountSettings = ButtonCountSettings + 1

local IslandDefs = {
    {label="–°—Ç–∞—Ä—Ç–æ–≤—ã–π –æ—Å—Ç—Ä–æ–≤", req=0, patterns={"starter","start","pirate"}},
    {label="–î–∂—É–Ω–≥–ª–∏ (15+)", req=15, patterns={"jungle"}},
    {label="–î–µ—Ä–µ–≤–Ω—è –ü–∏—Ä–∞—Ç–æ–≤ (30+)", req=30, patterns={"pirate village","pirate"}},
    {label="–ü—É—Å—Ç—ã–Ω—è (60+)", req=60, patterns={"desert"}},
    {label="–°—Ä–µ–¥–Ω–∏–π –û—Å—Ç—Ä–æ–≤", req=0, patterns={"middle","middle town"}},
    {label="–°–Ω–µ–∂–Ω—ã–π –û—Å—Ç—Ä–æ–≤ (90+)", req=90, patterns={"frozen","snow","frozen village"}},
    {label="–ú–æ—Ä—Å–∫–∞—è –ö—Ä–µ–ø–æ—Å—Ç—å (120+)", req=120, patterns={"marine fortress","marineford","marine"}},
    {label="–°–∫–∞–π–ø–∏—è (150+)", req=150, patterns={"sky","skypia","skylands"}},
    {label="–¢—é—Ä—å–º–∞ (190+)", req=190, patterns={"prison"}},
    {label="–ö–æ–ª–∏–∑–µ–π (225+)", req=225, patterns={"colosseum"}},
    {label="–ú–∞–≥–º–æ–≤–∞—è –î–µ—Ä–µ–≤–Ω—è (300+)", req=300, patterns={"magma village","magma"}},
    {label="–ü–æ–¥–≤–æ–¥–Ω—ã–π –ì–æ—Ä–æ–¥ (375+)", req=375, patterns={"underwater city","underwater","fishman"}},
    {label="–§–æ–Ω—Ç–∞–Ω–Ω—ã–π –ì–æ—Ä–æ–¥ (625+)", req=625, patterns={"fountain city","fountain"}}
}

local function GetIslandCFrame(def)
    for _, pat in ipairs(def.patterns) do
        local needle = string.lower(pat)
        for _, d in ipairs(Workspace:GetDescendants()) do
            local name = string.lower(d.Name)
            if string.find(name, needle) then
                if d:IsA("Model") then
                    local part = d.PrimaryPart
                    if not part then
                        for _, c in ipairs(d:GetDescendants()) do
                            if c:IsA("BasePart") then
                                part = c
                                break
                            end
                        end
                    end
                    if part then
                        return part.CFrame + Vector3.new(0, 7, 0)
                    end
                elseif d:IsA("BasePart") then
                    return d.CFrame + Vector3.new(0, 7, 0)
                end
            end
        end
    end
    return nil
end

local TweenService = game:GetService("TweenService")

local function TeleportToIsland(def)
    local lvl = 0
    if Player.Data and Player.Data:FindFirstChild("Level") then
        lvl = Player.Data.Level.Value
    end
    if lvl < def.req then
        return
    end
    if Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
        local cf = GetIslandCFrame(def)
        if cf then
            -- –û—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ—Ñ–∞—Ä–º, —á—Ç–æ–±—ã –Ω–µ —Ç—è–Ω—É–ª–æ –æ–±—Ä–∞—Ç–Ω–æ
            if _G.AutoFarm then
                _G.AutoFarm = false
                -- –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –≤ GUI, –µ—Å–ª–∏ –æ–Ω–∞ –µ—Å—Ç—å
                -- –ù–æ —É –Ω–∞—Å –Ω–µ—Ç –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–Ω–æ–ø–∫–µ, –ø–æ—ç—Ç–æ–º—É –ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
            end
            if _G.AutoQuest then _G.AutoQuest = false end
            
            -- –ò—Å–ø–æ–ª—å–∑—É–µ–º Tween –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∞ (–æ–±—Ö–æ–¥ –∞–Ω—Ç–∏—á–∏—Ç–∞)
            local dist = (Player.Character.HumanoidRootPart.Position - cf.Position).Magnitude
            if dist > 300 then
                local tweenInfo = TweenInfo.new(dist / 300, Enum.EasingStyle.Linear) -- –°–∫–æ—Ä–æ—Å—Ç—å ~300 —Å—Ç–∞–¥–æ–≤/—Å–µ–∫
                local tween = TweenService:Create(Player.Character.HumanoidRootPart, tweenInfo, {CFrame = cf})
                tween:Play()
                
                -- Noclip –≤–æ –≤—Ä–µ–º—è –ø–æ–ª–µ—Ç–∞
                local noclipConn
                noclipConn = RunService.Stepped:Connect(function()
                    if Player.Character then
                        for _, v in pairs(Player.Character:GetDescendants()) do
                            if v:IsA("BasePart") then v.CanCollide = false end
                        end
                    end
                end)
                
                tween.Completed:Connect(function()
                    if noclipConn then noclipConn:Disconnect() end
                    Player.Character.HumanoidRootPart.CFrame = cf -- –§–∏–Ω–∞–ª—å–Ω–∞—è —Ç–æ—á–∫–∞
                end)
            else
                Player.Character.HumanoidRootPart.CFrame = cf
            end
        end
    end
end

for _, def in ipairs(IslandDefs) do
    CreateButton(IslandsFrame, ButtonCountIslands, def.label, function()
        TeleportToIsland(def)
    end)
    ButtonCountIslands = ButtonCountIslands + 1
end

-- –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è (X)
local CloseBtn = Instance.new("TextButton")
CloseBtn.Parent = MainFrame
CloseBtn.BackgroundColor3 = Color3.fromRGB(255, 50, 50)
CloseBtn.Size = UDim2.new(0.12, 0, 0.12, 0)
CloseBtn.Position = UDim2.new(0.88, 0, 0, 0) -- –°–ø—Ä–∞–≤–∞ —Å–≤–µ—Ä—Ö—É
CloseBtn.Text = "X"
CloseBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 18
CloseBtn.ZIndex = 105

local UICornerClose = Instance.new("UICorner")
UICornerClose.CornerRadius = UDim.new(0.3, 0)
UICornerClose.Parent = CloseBtn

CloseBtn.Activated:Connect(function()
    MainFrame.Visible = false
end)

-- –¢–∞–π–º–µ—Ä —Ñ—Ä—É–∫—Ç–æ–≤
local FruitTimerLabel = Instance.new("TextLabel")
FruitTimerLabel.Parent = ScreenGui
FruitTimerLabel.Position = UDim2.new(0.05, 0, 0.08, 0)
FruitTimerLabel.Size = UDim2.new(0, 240, 0, 30)
FruitTimerLabel.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
FruitTimerLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
FruitTimerLabel.Font = Enum.Font.SourceSansBold
FruitTimerLabel.TextSize = 14
FruitTimerLabel.ZIndex = 110
FruitTimerLabel.Text = "–§—Ä—É–∫—Ç—ã: –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è..."

local UICornerTimer = Instance.new("UICorner")
UICornerTimer.CornerRadius = UDim.new(0.2, 0)
UICornerTimer.Parent = FruitTimerLabel

-- // –õ–û–ì–ò–ö–ê –°–ö–†–ò–ü–¢–ê //

-- // –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ö–í–ï–°–¢–û–í (FIRST SEA) //
local QuestList = {
    {Req=0, Name="BanditQuest1", Id=1, Mob="Bandit"},
    {Req=10, Name="JungleQuest", Id=1, Mob="Monkey"},
    {Req=15, Name="JungleQuest", Id=2, Mob="Gorilla"},
    {Req=20, Name="JungleQuest", Id=3, Mob="Gorilla King"},
    {Req=30, Name="BuggyQuest1", Id=1, Mob="Pirate"},
    {Req=40, Name="BuggyQuest1", Id=2, Mob="Brute"},
    {Req=60, Name="DesertQuest", Id=1, Mob="Desert Bandit"},
    {Req=75, Name="DesertQuest", Id=2, Mob="Desert Officer"},
    {Req=90, Name="SnowQuest", Id=1, Mob="Snow Bandit"},
    {Req=100, Name="SnowQuest", Id=2, Mob="Snowman"},
    {Req=120, Name="MarineQuest2", Id=1, Mob="Chief Petty Officer"},
    {Req=150, Name="SkyQuest", Id=1, Mob="Sky Bandit"},
    {Req=175, Name="SkyQuest", Id=2, Mob="Dark Master"},
    {Req=190, Name="PrisonerQuest", Id=1, Mob="Prisoner"},
    {Req=210, Name="PrisonerQuest", Id=2, Mob="Dangerous Prisoner"},
    {Req=225, Name="ColosseumQuest", Id=1, Mob="Toga Warrior"},
    {Req=275, Name="ColosseumQuest", Id=2, Mob="Gladiator"},
    {Req=300, Name="MagmaQuest", Id=1, Mob="Military Soldier"},
    {Req=325, Name="MagmaQuest", Id=2, Mob="Military Spy"},
    {Req=375, Name="FishmanQuest", Id=1, Mob="Fishman Warrior"},
    {Req=400, Name="FishmanQuest", Id=2, Mob="Fishman Commando"},
    {Req=450, Name="SkyExp1Quest", Id=1, Mob="God's Guard"},
    {Req=475, Name="SkyExp1Quest", Id=2, Mob="Shanda"},
    {Req=525, Name="SkyExp2Quest", Id=1, Mob="Royal Squad"},
    {Req=625, Name="FountainQuest", Id=1, Mob="Galley Pirate"},
    {Req=650, Name="FountainQuest", Id=2, Mob="Galley Captain"}
}

local function GetCurrentQuestConfig(level)
    for i = #QuestList, 1, -1 do
        if level >= QuestList[i].Req then
            if QuestList[i].Mob == "Gorilla King" then
                if not Workspace.Enemies:FindFirstChild("Gorilla King") then
                    continue
                end
            end
            return QuestList[i]
        end
    end
    return QuestList[1]
end

local function GetQuestTarget()
    local gui = Player:FindFirstChild("PlayerGui")
    if gui and gui:FindFirstChild("Main") and gui.Main:FindFirstChild("Quest") then
        local q = gui.Main.Quest
        if q.Visible then
            local t = q.Container.QuestTitle.Title.Text
            for _, cfg in pairs(QuestList) do
                if string.find(t, cfg.Mob) then return cfg.Mob end
            end
            if string.find(t, "Bandit") then return "Bandit" end
            if string.find(t, "Monkey") then return "Monkey" end
            if string.find(t, "Gorilla") then return "Gorilla" end
            if string.find(t, "Gorilla King") then return "Gorilla King" end
            if string.find(t, "Pirate") then return "Pirate" end
            if string.find(t, "Galley Pirate") then return "Galley Pirate" end
        end
    end
    return nil
end

local function EquipBest()
    local char = Player.Character
    if not char then return end
    local tool = char:FindFirstChildOfClass("Tool")
    if tool then return tool end
    for _, t in pairs(Player.Backpack:GetChildren()) do
        if t:IsA("Tool") and (t.ToolTip == "Melee" or t.Name == "Combat" or t.ToolTip == "Sword") then
            char.Humanoid:EquipTool(t)
            return t
        end
    end
end

-- –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ —Ñ—Ä—É–∫—Ç–æ–≤ –≤ Workspace
local function FindAllFruits()
    local fruits = {}
    for _, v in pairs(Workspace:GetChildren()) do
        if string.find(v.Name, "Fruit") and v:IsA("Tool") and v:FindFirstChild("Handle") then
            table.insert(fruits, v)
        end
    end
    return fruits
end

-- –°–∏—Å—Ç–µ–º–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–ø–∞–≤–Ω–∞ —Ñ—Ä—É–∫—Ç–æ–≤
local function UpdateFruitTracking()
    local currentFruits = FindAllFruits()
    local currentFruitNames = {}
    
    -- –°–æ–±–∏—Ä–∞–µ–º —Ç–µ–∫—É—â–∏–µ —Ñ—Ä—É–∫—Ç—ã
    for _, fruit in pairs(currentFruits) do
        currentFruitNames[fruit.Name] = true
    end
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ —Ñ—Ä—É–∫—Ç—ã (–∑–∞—Å–ø–∞–≤–Ω–∏–ª–∏—Å—å)
    for fruitName, _ in pairs(currentFruitNames) do
        if not FruitSpawnData.LastSeenFruits[fruitName] then
            -- –ù–æ–≤—ã–π —Ñ—Ä—É–∫—Ç –∑–∞—Å–ø–∞–≤–Ω–∏–ª—Å—è!
            local spawnTime = os.time()
            
            -- –ï—Å–ª–∏ –±—ã–ª –ø—Ä–µ–¥—ã–¥—É—â–∏–π –¥–µ—Å–ø–∞–≤–Ω, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª
            if FruitSpawnData.LastDespawnTime > 0 then
                local interval = spawnTime - FruitSpawnData.LastDespawnTime
                table.insert(FruitSpawnData.SpawnTimes, interval)
                
                -- –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ä–µ–¥–Ω–∏–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–ø–∞–≤–Ω–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 —Å–ø–∞–≤–Ω–æ–≤)
                if #FruitSpawnData.SpawnTimes > 5 then
                    table.remove(FruitSpawnData.SpawnTimes, 1)
                end
                
                local sum = 0
                for _, time in pairs(FruitSpawnData.SpawnTimes) do
                    sum = sum + time
                end
                FruitSpawnData.AverageSpawnTime = math.floor(sum / #FruitSpawnData.SpawnTimes)
            end
            
            FruitSpawnData.LastSeenFruits[fruitName] = spawnTime
        end
    end
    
    -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–µ—Å–ø–∞–≤–Ω —Ñ—Ä—É–∫—Ç–æ–≤
    for fruitName, _ in pairs(FruitSpawnData.LastSeenFruits) do
        if not currentFruitNames[fruitName] then
            -- –§—Ä—É–∫—Ç –∏—Å—á–µ–∑ (–¥–µ—Å–ø–∞–≤–Ω –∏–ª–∏ –ø–æ–¥–æ–±—Ä–∞–Ω)
            FruitSpawnData.LastSeenFruits[fruitName] = nil
            FruitSpawnData.LastDespawnTime = os.time()
        end
    end
    
    return currentFruits
end

-- –ê–≤—Ç–æ—Å–±–æ—Ä —Ñ—Ä—É–∫—Ç–æ–≤
task.spawn(function()
    while task.wait(2) do
        if _G.AutoCollectFruit and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            pcall(function()
                local fruits = FindAllFruits()
                local nearestFruit = nil
                local nearestDist = math.huge
                
                for _, fruit in pairs(fruits) do
                    local dist = (Player.Character.HumanoidRootPart.Position - fruit.Handle.Position).Magnitude
                    if dist < nearestDist then
                        nearestDist = dist
                        nearestFruit = fruit
                    end
                end
                
                if nearestFruit and nearestDist < 2000 then
                    Player.Character.HumanoidRootPart.CFrame = nearestFruit.Handle.CFrame
                    task.wait(0.3)
                end
            end)
        end
    end
end)

-- –ê–≤—Ç–æ—Ñ–∞—Ä–º —Ü–∏–∫–ª
task.spawn(function()
    while task.wait() do
        if _G.AutoFarm and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            pcall(function()
                -- 1. –ö–≤–µ—Å—Ç
    if _G.AutoQuest then
                    local gui = Player:FindFirstChild("PlayerGui")
                    if gui and gui:FindFirstChild("Main") and gui.Main:FindFirstChild("Quest") then
                        if gui.Main.Quest.Visible == false then
                            local lvl = Player.Data.Level.Value
                            local questConfig = GetCurrentQuestConfig(lvl)
                            if questConfig then
                                ReplicatedStorage.Remotes.CommF_:InvokeServer("StartQuest", questConfig.Name, questConfig.Id)
                            end
                        end
                    end
                end

                -- 2. –¶–µ–ª—å
                local targetName = GetQuestTarget()
                
                -- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–π —Ü–µ–ª–∏: –∂–∏–≤–∞ –ª–∏ –æ–Ω–∞ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–≤–µ—Å—Ç—É
                if CurrentTarget then
                    if not CurrentTarget.Parent or not CurrentTarget:FindFirstChild("Humanoid") or CurrentTarget.Humanoid.Health <= 0 then
                        CurrentTarget = nil
                    elseif targetName and not string.find(CurrentTarget.Name, targetName) then
                        -- –ï—Å–ª–∏ —É –Ω–∞—Å –µ—Å—Ç—å –∫–≤–µ—Å—Ç, –Ω–æ –º—ã –±—å–µ–º –∫–æ–≥–æ-—Ç–æ –¥—Ä—É–≥–æ–≥–æ -> —Å–±—Ä–æ—Å
                        CurrentTarget = nil
                    end
                end
                
                if not CurrentTarget then
                    local enemies = Workspace:FindFirstChild("Enemies")
                    local nearest = nil
                    local nearestDist = math.huge
                    if enemies and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                        for _, v in pairs(enemies:GetChildren()) do
                            if v:FindFirstChild("Humanoid") and v.Humanoid.Health > 0 and v:FindFirstChild("HumanoidRootPart") then
                                -- –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞:
                                -- 1. –ï—Å–ª–∏ –µ—Å—Ç—å –∫–≤–µ—Å—Ç (targetName), –∏—â–µ–º –°–¢–†–û–ì–û –º–æ–±–æ–≤ —Å —ç—Ç–∏–º –∏–º–µ–Ω–µ–º
                                -- 2. –ï—Å–ª–∏ –∫–≤–µ—Å—Ç–∞ –Ω–µ—Ç, –∏—â–µ–º –±–ª–∏–∂–∞–π—à–µ–≥–æ –ª—é–±–æ–≥–æ
                                
                                local match = false
                                if targetName then
                                    if string.find(v.Name, targetName) then
                                        match = true
                                    end
                                    -- –û—Å–æ–±–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –±–æ—Å—Å–æ–≤ (–∏–Ω–æ–≥–¥–∞ –∏–º—è –≤ –∫–≤–µ—Å—Ç–µ —á—É—Ç—å –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è)
                                    if not match and (string.find(v.Name, "Boss") or v.Humanoid.MaxHealth > 10000) then
                                         -- –ï—Å–ª–∏ —ç—Ç–æ –±–æ—Å—Å –∏ –µ–≥–æ –∏–º—è –ø–æ—Ö–æ–∂–µ –Ω–∞ –∫–≤–µ—Å—Ç
                                         if string.find(targetName, v.Name) or string.find(v.Name, targetName) then
                                             match = true
                                         end
                                    end
                                else
                                    match = true -- –ë–µ—Ä–µ–º –ª—é–±–æ–≥–æ, –µ—Å–ª–∏ –Ω–µ—Ç –∫–≤–µ—Å—Ç–∞
                                end
                                
                                if match then
                                    local dist = (Player.Character.HumanoidRootPart.Position - v.HumanoidRootPart.Position).Magnitude
                                    if dist < nearestDist then
                                        nearestDist = dist
                                        nearest = v
                                    end
                                end
                            end
                        end
                    end
                    CurrentTarget = nearest
                end
                local target = CurrentTarget

                -- 3. –ê—Ç–∞–∫–∞
                if target then
                    local weapon = EquipBest()
                    
                    -- –ü—Ä–∏–º–µ–Ω—è–µ–º Hitbox Reach –¢–û–õ–¨–ö–û –∫ —Ç–µ–∫—É—â–µ–π —Ü–µ–ª–∏ (—á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ –∫—É—á–∏)
                    if _G.ReachAura and target:FindFirstChild("HumanoidRootPart") then
                         target.HumanoidRootPart.Size = Vector3.new(50, 50, 50)
                         target.HumanoidRootPart.Transparency = 0.8
                         target.HumanoidRootPart.CanCollide = false
                    end

                    -- –ü–æ–∑–∏—Ü–∏—è –∞—Ç–∞–∫–∏: –ì–õ–û–ë–ê–õ–¨–ù–ê–Ø –ø–æ–∑–∏—Ü–∏—è –Ω–∞–¥ –º–æ–±–æ–º
                    -- –ò—Å–ø–æ–ª—å–∑—É–µ–º Vector3 –¥–ª—è —Å–º–µ—â–µ–Ω–∏—è, —á—Ç–æ–±—ã –≤—Ä–∞—â–µ–Ω–∏–µ –º–æ–±–∞ –Ω–µ –∫—Ä—É—Ç–∏–ª–æ –Ω–∞—Å
                    local attackPos = target.HumanoidRootPart.Position + Vector3.new(0, 7, 0) -- –°—Ç—Ä–æ–≥–æ —Å–≤–µ—Ä—Ö—É (+7 –±–ª–æ–∫–æ–≤)
                    
                    -- –¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è —Å –≤–∑–≥–ª—è–¥–æ–º –Ω–∞ –º–æ–±–∞ (LookAt)
                    Player.Character.HumanoidRootPart.CFrame = CFrame.lookAt(attackPos, target.HumanoidRootPart.Position)
                    Player.Character.HumanoidRootPart.Velocity = Vector3.zero -- –ì–∞—Å–∏–º –∏–Ω–µ—Ä—Ü–∏—é
                    
                    if weapon then 
                        weapon:Activate()
                        if _G.MobileAttackOnly then
                            local cam = Workspace.CurrentCamera
                            local cx = math.floor(cam.ViewportSize.X/2)
                            local cy = math.floor(cam.ViewportSize.Y/2)
                            task.spawn(function()
                                pcall(function()
                                    VirtualInputManager:SendMouseButtonEvent(cx, cy, 0, true, game, 1)
                                    task.wait(0.02)
                                    VirtualInputManager:SendMouseButtonEvent(cx, cy, 0, false, game, 1)
                                end)
                            end)
                        else
                            pcall(function()
                                VirtualUser:CaptureController()
                                VirtualUser:ClickButton1(Vector2.new(800, 600), Workspace.CurrentCamera.CFrame)
                            end)
                        end
                    end
                end
            end)
        end
    end
end)

-- ESP —Ü–∏–∫–ª —Å —Ä–µ–∞–ª—å–Ω—ã–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º —Å–ø–∞–≤–Ω–∞
task.spawn(function()
    while task.wait(1) do
        pcall(function()
            local currentFruits = UpdateFruitTracking()
            
            if _G.FruitESP then
                for _, fruit in pairs(currentFruits) do
                    if not fruit.Handle:FindFirstChild("FruitESP") then
                        local b = Instance.new("BillboardGui")
                        b.Name = "FruitESP"
                        b.Adornee = fruit.Handle
                        b.Size = UDim2.new(0, 200, 0, 50)
                        b.StudsOffset = Vector3.new(0, 2, 0)
                        b.AlwaysOnTop = true
                        
                        local t = Instance.new("TextLabel")
                        t.Parent = b
                        t.Size = UDim2.new(1,0,1,0)
                        t.BackgroundTransparency = 1
                        t.TextColor3 = Color3.fromRGB(255, 0, 0)
                        t.TextStrokeTransparency = 0
                        t.Font = Enum.Font.SourceSansBold
                        t.TextSize = 14
                        t.Text = fruit.Name
                        b.Parent = fruit.Handle
                    end
                    
                    -- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
                    if fruit.Handle:FindFirstChild("FruitESP") and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
                        local dist = math.floor((Player.Character.HumanoidRootPart.Position - fruit.Handle.Position).Magnitude)
                        fruit.Handle.FruitESP.TextLabel.Text = fruit.Name .. " [" .. dist .. "m]"
                    end
                end
            else
                -- –û—á–∏—Å—Ç–∫–∞ ESP
                for _, fruit in pairs(currentFruits) do
                    if fruit.Handle:FindFirstChild("FruitESP") then
                        fruit.Handle.FruitESP:Destroy()
                    end
                end
            end
            
            -- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞
            if #currentFruits > 0 then
                FruitTimerLabel.Text = "üçé –§—Ä—É–∫—Ç–æ–≤: " .. #currentFruits .. " | –°–ª–µ–¥. —á–µ—Ä–µ–∑ ~" .. math.floor(FruitSpawnData.AverageSpawnTime/60) .. "–º"
            else
                if FruitSpawnData.LastDespawnTime > 0 then
                    local elapsed = os.time() - FruitSpawnData.LastDespawnTime
                    local remaining = math.max(0, FruitSpawnData.AverageSpawnTime - elapsed)
                    local m = math.floor(remaining/60)
                    local s = remaining % 60
                    FruitTimerLabel.Text = string.format("‚è∞ –°–ª–µ–¥—É—é—â–∏–π —Ñ—Ä—É–∫—Ç: ~%02d:%02d", m, s)
                else
                    FruitTimerLabel.Text = "‚è∞ –û–∂–∏–¥–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ —Å–ø–∞–≤–Ω–µ..."
                end
            end
        end)
    end
end)

-- Noclip
RunService.Stepped:Connect(function()
    if _G.AutoFarm and Player.Character then
        for _, v in pairs(Player.Character:GetDescendants()) do
            if v:IsA("BasePart") then v.CanCollide = false end
        end
    end
end)

-- Hitbox Expander (Reach Aura) - –ì–ª–æ–±–∞–ª—å–Ω—ã–π —Ü–∏–∫–ª —É–¥–∞–ª–µ–Ω, —Ç–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Ç–æ—á–µ—á–Ω–æ –∫ —Ü–µ–ª–∏
--[[
task.spawn(function()
    while task.wait(0.5) do
        if _G.ReachAura then
             -- –õ–æ–≥–∏–∫–∞ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞ –≤ AutoFarm —Ü–∏–∫–ª –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ª–∞–≥–æ–≤ –∏ "–∫—É—á–∏"
        end
    end
end)
]]

-- // SERVER FRUIT HOP (–°–µ—Ä–≤–µ—Ä –•–æ–ø) //
local function ServerHop()
    -- –ü–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ API (–¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ executor'–æ–≤)
    -- –ï—Å–ª–∏ –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π —Ö–æ–ø
    pcall(function()
        local PlaceID = game.PlaceId
        local AllIDs = {}
        local found = false
        local pageCursor = ""
        local num = 0
        
        -- –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å
        local statusLabel = Player.PlayerGui:FindFirstChild("BloxFruitMobileGUI_v3")
        if statusLabel and statusLabel:FindFirstChild("FruitTimerLabel") then
            statusLabel.FruitTimerLabel.Text = "‚è≥ –ò—â–µ–º –Ω–æ–≤—ã–π —Å–µ—Ä–≤–µ—Ä..."
        end
        
        -- –ü—Ä–æ–±—É–µ–º –Ω–∞–π—Ç–∏ —Å–µ—Ä–≤–µ—Ä–∞
        while not found do
            local success, result = pcall(function()
                return HttpService:JSONDecode(game:HttpGet("https://games.roblox.com/v1/games/" .. PlaceID .. "/servers/Public?sortOrder=Asc&limit=100&cursor=" .. pageCursor))
            end)
            
            if success and result and result.data then
                for i, v in pairs(result.data) do
                    -- –ò—â–µ–º —Å–µ—Ä–≤–µ—Ä, –≥–¥–µ –µ—Å—Ç—å –º–µ—Å—Ç–æ (–º–µ–Ω—å—à–µ –º–∞–∫—Å–∏–º—É–º–∞ - 1) –∏ –Ω–µ —Ç–µ–∫—É—â–∏–π
                    if v.playing < v.maxPlayers and v.id ~= game.JobId then
                        local possible = true
                        -- –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø–∏–Ω–≥–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                        if possible then
                            TeleportService:TeleportToPlaceInstance(PlaceID, v.id, Player)
                            found = true
                            break
                        end
                    end
                end
            end
            
            if found then break end
            
            if result and result.nextPageCursor then
                pageCursor = result.nextPageCursor
            else
                -- –ï—Å–ª–∏ —Å–ø–∏—Å–æ–∫ –∑–∞–∫–æ–Ω—á–∏–ª—Å—è, –Ω–∞—á–∏–Ω–∞–µ–º —Å–Ω–∞—á–∞–ª–∞ (–∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω—ã–π —Ç–µ–ª–µ–ø–æ—Ä—Ç, –µ—Å–ª–∏ API –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
                break
            end
            task.wait(0.5)
        end
        
        if not found then
            -- Fallback: –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞—Ö–æ–¥–∏–º, –Ω–∞–¥–µ—è—Å—å –Ω–∞ —Ä–∞–Ω–¥–æ–º
             TeleportService:Teleport(PlaceID, Player)
        end
    end)
end

-- –õ–æ–≥–∏–∫–∞ Server Fruit Hop
task.spawn(function()
    while task.wait(5) do
        if _G.ServerFruitHop then
            pcall(function()
                local fruits = FindAllFruits()
                if #fruits > 0 then
                    -- –§—Ä—É–∫—Ç—ã –Ω–∞–π–¥–µ–Ω—ã! 
                    -- –í–∫–ª—é—á–∞–µ–º —Å–±–æ—Ä, –µ—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω
                    if not _G.AutoCollectFruit then
                         -- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –≤–∫–ª—é—á–∏—Ç—å
                         -- _G.AutoCollectFruit = true 
                         -- –ù–æ –ª—É—á—à–µ –ø—Ä–æ—Å—Ç–æ —Ç–µ–ª–µ–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑
                         local nearestFruit = fruits[1] -- –ë–µ—Ä–µ–º –ø–µ—Ä–≤—ã–π –ø–æ–ø–∞–≤—à–∏–π—Å—è
                         if nearestFruit and nearestFruit:FindFirstChild("Handle") then
                             Player.Character.HumanoidRootPart.CFrame = nearestFruit.Handle.CFrame
                         end
                    end
                    -- –ù–µ –º–µ–Ω—è–µ–º —Å–µ—Ä–≤–µ—Ä, –ø–æ–∫–∞ –µ—Å—Ç—å —Ñ—Ä—É–∫—Ç—ã
                else
                    -- –§—Ä—É–∫—Ç–æ–≤ –Ω–µ—Ç -> –º–µ–Ω—è–µ–º —Å–µ—Ä–≤–µ—Ä
                    ServerHop()
                end
            end)
        end
    end
end)

-- –ê–≤—Ç–æ-–ø—Ä–æ–∫–∞—á–∫–∞ —Å—Ç–∞—Ç–æ–≤ (Smart)
task.spawn(function()
    while task.wait(0.2) do
        if _G.AutoStats then
            pcall(function()
                local stat = _G.SelectStat or "Melee"
                -- –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –∏–º–µ–Ω–∏ —Å—Ç–∞—Ç–∞ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ (–æ–±—ã—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—é—Ç)
                -- Melee, Defense, Sword, Gun, Demon Fruit
                
                local args = {
                    [1] = "AddPoint",
                    [2] = stat,
                    [3] = 1
                }
                ReplicatedStorage.Remotes.CommF_:InvokeServer(unpack(args))
            end)
        end
    end
end)

-- –ê–≤—Ç–æ-–ø–æ–∫—É–ø–∫–∞ —Ä–∞–Ω–¥–æ–º–Ω–æ–≥–æ —Ñ—Ä—É–∫—Ç–∞
task.spawn(function()
    while task.wait(4) do
        if _G.AutoBuyRandomFruit then
            pcall(function()
                 ReplicatedStorage.Remotes.CommF_:InvokeServer("Cousin", "Buy")
            end)
        end
    end
end)

-- –ê–Ω—Ç–∏-–∫–∏–∫
local mt = getrawmetatable(game)
local oldNamecall = mt.__namecall
setreadonly(mt, false)
mt.__namecall = newcclosure(function(...)
    local method = getnamecallmethod()
    local args = {...}
    if method == "Kick" then
        return wait(9e9)
    end
    return oldNamecall(...)
end)
setreadonly(mt, true)

-- –ê–Ω—Ç–∏-AFK
Player.Idled:Connect(function()
    VirtualUser:CaptureController()
    VirtualUser:ClickButton2(Vector2.new())
end)

print("‚úÖ Blox Fruits Script v3 –∑–∞–≥—Ä—É–∂–µ–Ω!")
print("üì± –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É MENU –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è")
print("üçé –†–µ–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å–ø–∞–≤–Ω–∞ —Ñ—Ä—É–∫—Ç–æ–≤ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ!")

-- // SMART AI & PVP //

-- –§—É–Ω–∫—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–∫–∏–ª–ª–æ–≤
local function UseSkill(key)
    VirtualInputManager:SendKeyEvent(true, key, false, game)
    task.wait(0.05)
    VirtualInputManager:SendKeyEvent(false, key, false, game)
end

-- –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –ò–ò
task.spawn(function()
    while task.wait(0.1) do
        if _G.SmartAI then
            pcall(function()
                local target = CurrentTarget
                
                -- –ï—Å–ª–∏ –Ω–µ—Ç —Ü–µ–ª–∏ –æ—Ç —Ñ–µ—Ä–º—ã, –Ω–æ –≤–∫–ª—é—á–µ–Ω –ü–≤–ü, –∏—â–µ–º –∏–≥—Ä–æ–∫–∞
                if not target and _G.AutoPvP then
                    local minDist = math.huge
                    local closest = nil
                    for _, p in pairs(Players:GetPlayers()) do
                        if p ~= Player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") and p.Character:FindFirstChild("Humanoid") and p.Character.Humanoid.Health > 0 then
                            local dist = (Player.Character.HumanoidRootPart.Position - p.Character.HumanoidRootPart.Position).Magnitude
                            if dist < minDist then
                                minDist = dist
                                closest = p.Character
                            end
                        end
                    end
                    target = closest
                    CurrentTarget = target -- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω—É—é —Ü–µ–ª—å
                end
                
                if target and target:FindFirstChild("HumanoidRootPart") and target:FindFirstChild("Humanoid") and target.Humanoid.Health > 0 then
                    local dist = (Player.Character.HumanoidRootPart.Position - target.HumanoidRootPart.Position).Magnitude
                    
                    -- 1. –î–≤–∏–∂–µ–Ω–∏–µ –∫ —Ü–µ–ª–∏ (–ü–≤–ü)
                    if _G.AutoPvP and dist > 10 then
                        Player.Character.HumanoidRootPart.CFrame = CFrame.new(Player.Character.HumanoidRootPart.Position, target.HumanoidRootPart.Position) * CFrame.new(0, 0, -5) -- –ò–¥–µ–º –≤–ø–µ—Ä–µ–¥
                        -- –ò–ª–∏ —Ç–µ–ª–µ–ø–æ—Ä—Ç –µ—Å–ª–∏ –¥–∞–ª–µ–∫–æ
                        if dist > 50 then
                             Player.Character.HumanoidRootPart.CFrame = target.HumanoidRootPart.CFrame * CFrame.new(0, 20, 0)
                        else
                            -- "Pro" –¥–≤–∏–∂–µ–Ω–∏–µ: —Å—Ç—Ä–µ–π—Ñ
                            local t = os.clock()
                            local offsetX = math.sin(t * 3) * 15
                            local offsetZ = math.cos(t * 3) * 15
                            local newPos = target.HumanoidRootPart.Position + Vector3.new(offsetX, 10, offsetZ)
                            Player.Character.HumanoidRootPart.CFrame = CFrame.lookAt(newPos, target.HumanoidRootPart.Position)
                        end
                    end
                    
                    -- 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–∫–∏–ª–ª–æ–≤ (Z, X, C, V)
                    if dist < 100 then -- –î–∏—Å—Ç–∞–Ω—Ü–∏—è –∞—Ç–∞–∫–∏
                         UseSkill(Enum.KeyCode.Z)
                         task.wait(0.1)
                         UseSkill(Enum.KeyCode.X)
                         task.wait(0.1)
                         UseSkill(Enum.KeyCode.C)
                         task.wait(0.1)
                         UseSkill(Enum.KeyCode.V)
                         -- –ö–ª–∏–∫ –º—ã—à–∫–æ–π –º–µ–∂–¥—É —Å–∫–∏–ª–ª–∞–º–∏
                         VirtualUser:ClickButton1(Vector2.new())
                    end
                    
                    -- 3. Aimbot
                    if _G.AimBot then
                        local camera = Workspace.CurrentCamera
                        camera.CFrame = CFrame.new(camera.CFrame.Position, target.HumanoidRootPart.Position)
                    end
                end
            end)
        end
    end
end)

-- Auto Aura (Haki)
task.spawn(function()
    while task.wait(5) do
        if _G.AutoHaki then
             pcall(function()
                 local hasHaki = Player.Character and Player.Character:FindFirstChild("HasBuso")
                 if not hasHaki then
                     ReplicatedStorage.Remotes.CommF_:InvokeServer("Buso")
                 end
             end)
        end
    end
end)

-- Chest ESP
task.spawn(function()
    while task.wait(2) do
        pcall(function()
             if _G.ChestESP then
                 for _, v in pairs(Workspace:GetDescendants()) do
                     if string.find(v.Name, "Chest") and (v:IsA("Part") or v:IsA("MeshPart")) then
                         if not v:FindFirstChild("ChestESP") then
                             local b = Instance.new("BillboardGui")
                             b.Name = "ChestESP"
                             b.Adornee = v
                             b.Size = UDim2.new(0, 100, 0, 30)
                             b.StudsOffset = Vector3.new(0, 2, 0)
                             b.AlwaysOnTop = true
                             
                             local t = Instance.new("TextLabel")
                             t.Parent = b
                             t.Size = UDim2.new(1,0,1,0)
                             t.BackgroundTransparency = 1
                             t.TextColor3 = Color3.fromRGB(255, 255, 0) -- –ñ–µ–ª—Ç—ã–π
                             t.TextStrokeTransparency = 0
                             t.Font = Enum.Font.SourceSansBold
                             t.TextSize = 12
                             t.Text = "Chest"
                             b.Parent = v
                         end
                     end
                 end
             else
                 for _, v in pairs(Workspace:GetDescendants()) do
                     if v.Name == "ChestESP" then v:Destroy() end
                 end
             end
        end)
    end
end)

-- Speed Boost
task.spawn(function()
    while task.wait() do
        if _G.SpeedBoost and Player.Character and Player.Character:FindFirstChild("Humanoid") then
            Player.Character.Humanoid.WalkSpeed = 60
        end
    end
end)

-- Walk On Water (Jesus Mode)
task.spawn(function()
    local platform = Instance.new("Part")
    platform.Name = "WaterWalker"
    platform.Size = Vector3.new(20, 1, 20)
    platform.Transparency = 0.8
    platform.Anchored = true
    platform.CanCollide = true
    platform.Material = Enum.Material.Glass
    platform.Color = Color3.fromRGB(0, 255, 255)
    
    while task.wait() do
        if _G.WalkOnWater and Player.Character and Player.Character:FindFirstChild("HumanoidRootPart") then
            local hrp = Player.Character.HumanoidRootPart
            -- –£—Ä–æ–≤–µ–Ω—å –≤–æ–¥—ã –æ–±—ã—á–Ω–æ —á—É—Ç—å –Ω–∏–∂–µ 0 –∏–ª–∏ –Ω–∞ 0, –Ω–æ –ª—É—á—à–µ –¥–µ—Ä–∂–∞—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –ø—Ä—è–º–æ –ø–æ–¥ –Ω–æ–≥–∞–º–∏ –µ—Å–ª–∏ –º—ã –Ω–∞–¥ –≤–æ–¥–æ–π
            -- –í Blox Fruits –≤–æ–¥–∞ –Ω–µ –≤—Å–µ–≥–¥–∞ –Ω–∞ Y=0, –Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –±—É–¥–µ–º –¥–µ—Ä–∂–∞—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –ø–æ–¥ –∏–≥—Ä–æ–∫–æ–º
            
            -- –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞–¥ –≤–æ–¥–æ–π –ª–∏ –º—ã (Raycast –≤–Ω–∏–∑)
            -- –ù–æ –ø—Ä–æ—â–µ –ø—Ä–æ—Å—Ç–æ –¥–µ—Ä–∂–∞—Ç—å –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –ø–æ–¥ –Ω–æ–≥–∞–º–∏, –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ
            platform.Parent = Workspace
            platform.CFrame = CFrame.new(hrp.Position.X, hrp.Position.Y - 3.5, hrp.Position.Z)
        else
            if platform.Parent then platform.Parent = nil end
        end
    end
end)

-- Infinite Geppo
local UserInputService = game:GetService("UserInputService")
UserInputService.JumpRequest:Connect(function()
    if _G.InfGeppo and Player.Character and Player.Character:FindFirstChild("Humanoid") then
        Player.Character.Humanoid:ChangeState("Jumping")
    end
end)
